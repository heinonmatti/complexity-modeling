<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Mechanisms supplement</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Visualising baseline characteristics</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About</a>
</li>
<li>
  <a href="El-Rogier.html">Rogier</a>
</li>
<li>
  <a href="complexity-manuscript.html">Manuscript (LATER)</a>
</li>
<li>
  <a href="mechanisms-supplement.html">Analyses</a>
</li>
<li>
  <a href="Latent change score models.html">Latent change score models</a>
</li>
<li>
  <a href="https://raw.githubusercontent.com/heinonmatti/complexity-modeling/master/T1_plus_T3-datasetup.R">Data setup code</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Mechanisms supplement</h1>

</div>


<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;T1_plus_T3-datasetup.R&quot;</span>)</code></pre></div>
<div id="pa-motivation-changes-examined" class="section level1">
<h1>PA motivation changes examined</h1>
<div id="baseline-scores" class="section level2">
<h2>Baseline scores</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">18</span>
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1, 
  PA_integrated_02_T1,
  PA_integrated_03_T1, 
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1)


motiGirls &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">5.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiBoys &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">5.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiInt &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">5.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiCont &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T1,
  PA_amotivation_01_T1,
  PA_amotivation_03_T1,
  PA_amotivation_04_T1,
  PA_extrinsic_01_T1,
  PA_extrinsic_02_T1,
  PA_extrinsic_03_T1,
  PA_introjected_01_T1,
  PA_introjected_02_T1,
  PA_identified_01_T1,
  PA_identified_02_T1,
  PA_identified_03_T1,
  PA_integrated_01_T1,
  PA_integrated_02_T1,
  PA_integrated_03_T1,
  PA_intrinsic_01_T1,
  PA_intrinsic_02_T1,
  PA_intrinsic_03_T1) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">5.5</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(motiInt, motiGirls, motiCont, motiBoys, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(<span class="kw">ggplotGrob</span>(motiInt), <span class="kw">ggplotGrob</span>(motiCont), <span class="kw">ggplotGrob</span>(motiGirls), <span class="kw">ggplotGrob</span>(motiBoys), <span class="dt">size =</span> <span class="st">&quot;last&quot;</span>))
## Warning: Removed 196 rows containing non-finite values (stat_binline).
## Warning: Removed 142 rows containing non-finite values (stat_binline).
## Warning: Removed 215 rows containing non-finite values (stat_binline).
## Warning: Removed 123 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/motivation-baseline-histograms-1.png" width="2100" /></p>
</div>
<div id="change-scores" class="section level2">
<h2>Change scores</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
nItems &lt;-<span class="st"> </span><span class="dv">18</span>
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_diff,
  PA_amotivation_01_diff,
  PA_amotivation_03_diff,
  PA_amotivation_04_diff,
  PA_extrinsic_01_diff,
  PA_extrinsic_02_diff,
  PA_extrinsic_03_diff,
  PA_introjected_01_diff,
  PA_introjected_02_diff,
  PA_identified_01_diff,
  PA_identified_02_diff,
  PA_identified_03_diff,
  PA_integrated_01_diff, 
  PA_integrated_02_diff,
  PA_integrated_03_diff, 
  PA_intrinsic_01_diff,
  PA_intrinsic_02_diff,
  PA_intrinsic_03_diff)


motiGirls &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_diff,
  PA_amotivation_01_diff,
  PA_amotivation_03_diff,
  PA_amotivation_04_diff,
  PA_extrinsic_01_diff,
  PA_extrinsic_02_diff,
  PA_extrinsic_03_diff,
  PA_introjected_01_diff,
  PA_introjected_02_diff,
  PA_identified_01_diff,
  PA_identified_02_diff,
  PA_identified_03_diff,
  PA_integrated_01_diff,
  PA_integrated_02_diff,
  PA_integrated_03_diff,
  PA_intrinsic_01_diff,
  PA_intrinsic_02_diff,
  PA_intrinsic_03_diff) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;girl&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Girls&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiBoys &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_diff,
  PA_amotivation_01_diff,
  PA_amotivation_03_diff,
  PA_amotivation_04_diff,
  PA_extrinsic_01_diff,
  PA_extrinsic_02_diff,
  PA_extrinsic_03_diff,
  PA_introjected_01_diff,
  PA_introjected_02_diff,
  PA_identified_01_diff,
  PA_identified_02_diff,
  PA_identified_03_diff,
  PA_integrated_01_diff,
  PA_integrated_02_diff,
  PA_integrated_03_diff,
  PA_intrinsic_01_diff,
  PA_intrinsic_02_diff,
  PA_intrinsic_03_diff) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(girl <span class="op">==</span><span class="st"> &quot;boy&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkolivegreen2&quot;</span>, <span class="st">&quot;darkolivegreen4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boys&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiInt &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_diff,
  PA_amotivation_01_diff,
  PA_amotivation_03_diff,
  PA_amotivation_04_diff,
  PA_extrinsic_01_diff,
  PA_extrinsic_02_diff,
  PA_extrinsic_03_diff,
  PA_introjected_01_diff,
  PA_introjected_02_diff,
  PA_identified_01_diff,
  PA_identified_02_diff,
  PA_identified_03_diff,
  PA_integrated_01_diff,
  PA_integrated_02_diff,
  PA_integrated_03_diff,
  PA_intrinsic_01_diff,
  PA_intrinsic_02_diff,
  PA_intrinsic_03_diff) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Intervention&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

motiCont &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_diff,
  PA_amotivation_01_diff,
  PA_amotivation_03_diff,
  PA_amotivation_04_diff,
  PA_extrinsic_01_diff,
  PA_extrinsic_02_diff,
  PA_extrinsic_03_diff,
  PA_introjected_01_diff,
  PA_introjected_02_diff,
  PA_identified_01_diff,
  PA_identified_02_diff,
  PA_identified_03_diff,
  PA_integrated_01_diff,
  PA_integrated_02_diff,
  PA_integrated_03_diff,
  PA_intrinsic_01_diff,
  PA_intrinsic_02_diff,
  PA_intrinsic_03_diff) <span class="op">%&gt;%</span>
<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(.)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value, <span class="dt">y =</span> Variable, <span class="dt">group =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges2</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Variable), <span class="dt">stat =</span> <span class="st">&quot;binline&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">scale =</span> <span class="fl">0.95</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),
                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, <span class="dt">labels =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;deepskyblue4&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Control&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">y =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>),
        <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>))
## Warning: attributes are not identical across measure variables;
## they will be dropped

<span class="co">#grid.arrange(motiInt, motiGirls, motiCont, motiBoys, ncol = 2)</span>

<span class="co"># (&quot;Seldom or never&quot;, &quot;About once a month&quot;, &quot;About once a week&quot;, &quot;Almost daily&quot;)</span>

<span class="co"># This draws all histograms next to each other:</span>
grid<span class="op">::</span><span class="kw">grid.newpage</span>()
grid<span class="op">::</span><span class="kw">grid.draw</span>(<span class="kw">cbind</span>(<span class="kw">ggplotGrob</span>(motiInt), <span class="kw">ggplotGrob</span>(motiCont), <span class="kw">ggplotGrob</span>(motiGirls), <span class="kw">ggplotGrob</span>(motiBoys), <span class="dt">size =</span> <span class="st">&quot;last&quot;</span>))
## Warning: Removed 2341 rows containing non-finite values (stat_binline).
## Warning: Removed 1804 rows containing non-finite values (stat_binline).
## Warning: Removed 2239 rows containing non-finite values (stat_binline).
## Warning: Removed 1906 rows containing non-finite values (stat_binline).</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/motivation-difference-histograms-1.png" width="2100" /></p>
</div>
</div>
<div id="confidence-intervals" class="section level1">
<h1>Confidence intervals</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># names &lt;- df %&gt;% dplyr::select(-id, -intervention, -group, -school, -girl, -track, -trackSchool, -contains(&quot;_T1&quot;), -contains(&quot;_T3&quot;)) %&gt;% names(.)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for boys; when boy is 1, girl is 0, but boy is a factor, so intercept is for boys even though boy is 1 for boys and 0 for girls.</span>
<span class="co"># m.boys &lt;- NA</span>
<span class="co"># mean.boys &lt;- NA</span>
<span class="co"># m_p.boys &lt;- NA</span>
<span class="co"># ci_low.boys &lt;- NA</span>
<span class="co"># ci_high.boys &lt;- NA</span>
<span class="co"># ICC_group.boys &lt;- NA</span>
<span class="co"># ICC_School.boys &lt;- NA</span>
<span class="co"># nonmissings.boys &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.boys &lt;- df %&gt;% dplyr::mutate(boy = factor(ifelse(girl == &quot;girl&quot;, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.boys &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + boy&quot;), data=df.boys)</span>
<span class="co"># mean.boys[i] &lt;- lme4::fixef(m.boys)[1]</span>
<span class="co"># m_p.boys &lt;- profile(m.boys, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.boys[i] &lt;- confint(m_p.boys)[1, 1]</span>
<span class="co"># ci_high.boys[i] &lt;- confint(m_p.boys)[1, 2]</span>
<span class="co"># ICC_group.boys[i] &lt;- sjstats::icc(m.boys)[1]</span>
<span class="co"># ICC_School.boys[i] &lt;- sjstats::icc(m.boys)[2]</span>
<span class="co"># nonmissings.boys[i] &lt;- length(m.boys@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for girls:&quot;, labels(lme4::fixef(m.boys))[2] == &quot;boy0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_boys &lt;- data.frame(ciLo = ci_low.boys, mean = mean.boys, ciHi = ci_high.boys)</span>
<span class="co"># diamondlabels &lt;- labels(ci_boys)[[1]]</span>
<span class="co"># ci_boys &lt;- data.frame(ci_boys, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for girls; when boy is 1, girl is 0, but boy is a factor, so intercept is for girls even though girl is 1 for girls and 0 for boys.</span>
<span class="co"># m.girls &lt;- NA</span>
<span class="co"># mean.girls &lt;- NA</span>
<span class="co"># m_p.girls &lt;- NA</span>
<span class="co"># ci_low.girls &lt;- NA</span>
<span class="co"># ci_high.girls &lt;- NA</span>
<span class="co"># ICC_group.girls &lt;- NA</span>
<span class="co"># ICC_School.girls &lt;- NA</span>
<span class="co"># nonmissings.girls &lt;- NA</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.girls &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + girl&quot;), data=df)</span>
<span class="co"># mean.girls[i] &lt;- lme4::fixef(m.girls)[1]</span>
<span class="co"># m_p.girls &lt;- profile(m.girls, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.girls[i] &lt;- confint(m_p.girls)[1, 1]</span>
<span class="co"># ci_high.girls[i] &lt;- confint(m_p.girls)[1, 2]</span>
<span class="co"># ICC_group.girls[i] &lt;- sjstats::icc(m.girls)[1]</span>
<span class="co"># ICC_School.girls[i] &lt;- sjstats::icc(m.girls)[2]</span>
<span class="co"># nonmissings.girls[i] &lt;- length(m.girls@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for boys:&quot;, labels(lme4::fixef(m.girls))[2] == &quot;girl0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_girls &lt;- data.frame(ciLo = ci_low.girls, mean = mean.girls, ciHi = ci_high.girls)</span>
<span class="co"># diamondlabels &lt;- labels(ci_girls)[[1]]</span>
<span class="co"># ci_girls &lt;- data.frame(ci_girls, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># # Intercepts for intervention</span>
<span class="co"># m.intervention &lt;- NA</span>
<span class="co"># mean.intervention &lt;- NA</span>
<span class="co"># m_p.intervention &lt;- NA</span>
<span class="co"># ci_low.intervention &lt;- NA</span>
<span class="co"># ci_high.intervention &lt;- NA</span>
<span class="co"># ICC_group.intervention &lt;- NA</span>
<span class="co"># ICC_School.intervention &lt;- NA</span>
<span class="co"># nonmissings.intervention &lt;- NA</span>
<span class="co"># </span>
<span class="co"># ## change &quot;intervention&quot; to be consistent regarding level order with &quot;girl&quot;.</span>
<span class="co"># df.intervention &lt;- df %&gt;% dplyr::mutate(intervention = factor(intervention, levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.intervention &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + intervention&quot;), data=df.intervention)</span>
<span class="co"># mean.intervention[i] &lt;- lme4::fixef(m.intervention)[1]</span>
<span class="co"># m_p.intervention &lt;- profile(m.intervention, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.intervention[i] &lt;- confint(m_p.intervention)[1, 1]</span>
<span class="co"># ci_high.intervention[i] &lt;- confint(m_p.intervention)[1, 2]</span>
<span class="co"># ICC_group.intervention[i] &lt;- sjstats::icc(m.intervention)[1]</span>
<span class="co"># ICC_School.intervention[i] &lt;- sjstats::icc(m.intervention)[2]</span>
<span class="co"># nonmissings.intervention[i] &lt;- length(m.intervention@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for control:&quot;, labels(lme4::fixef(m.intervention))[2] == &quot;intervention0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_intervention &lt;- data.frame(ciLo = ci_low.intervention, mean = mean.intervention, ciHi = ci_high.intervention)</span>
<span class="co"># diamondlabels &lt;- labels(ci_intervention)[[1]]</span>
<span class="co"># ci_intervention &lt;- data.frame(ci_intervention, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # Intercepts for control</span>
<span class="co"># </span>
<span class="co"># m.control &lt;- NA</span>
<span class="co"># mean.control &lt;- NA</span>
<span class="co"># m_p.control &lt;- NA</span>
<span class="co"># ci_low.control &lt;- NA</span>
<span class="co"># ci_high.control &lt;- NA</span>
<span class="co"># ICC_group.control &lt;- NA</span>
<span class="co"># ICC_School.control &lt;- NA</span>
<span class="co"># nonmissings.control &lt;- NA</span>
<span class="co"># </span>
<span class="co"># df.control &lt;- df %&gt;% dplyr::mutate(control = factor(ifelse(intervention == 1, 0, 1), levels = c(1, 0)))</span>
<span class="co"># </span>
<span class="co"># for (i in names){</span>
<span class="co"># m.control &lt;- lme4::lmer(paste0(i,&quot; ~ (1|school) + (1|group) + control&quot;), data=df.control)</span>
<span class="co"># mean.control[i] &lt;- lme4::fixef(m.control)[1]</span>
<span class="co"># m_p.control &lt;- profile(m.control, which = &quot;beta_&quot;)</span>
<span class="co"># ci_low.control[i] &lt;- confint(m_p.control)[1, 1]</span>
<span class="co"># ci_high.control[i] &lt;- confint(m_p.control)[1, 2]</span>
<span class="co"># ICC_group.control[i] &lt;- sjstats::icc(m.control)[1]</span>
<span class="co"># ICC_School.control[i] &lt;- sjstats::icc(m.control)[2]</span>
<span class="co"># nonmissings.control[i] &lt;- length(m.control@resp$y)</span>
<span class="co"># }</span>
<span class="co"># </span>
<span class="co"># cat(&quot;The labels are arranged such that intercept is not for intervention:&quot;, labels(lme4::fixef(m.control))[2] == &quot;control0&quot;)</span>
<span class="co"># </span>
<span class="co"># ci_control &lt;- data.frame(ciLo = ci_low.control, mean = mean.control, ciHi = ci_high.control)</span>
<span class="co"># diamondlabels &lt;- labels(ci_control)[[1]]</span>
<span class="co"># ci_control &lt;- data.frame(ci_control, diamondlabels)</span>
<span class="co"># </span>
<span class="co"># # # Same ICC results you&#39;d get with e.g.:</span>
<span class="co"># # m1 &lt;- as.data.frame(VarCorr(m))</span>
<span class="co"># # m1$vcov[1] / (m1$vcov[1] + m1$vcov[3])</span>
<span class="co"># </span>
<span class="co"># # Or from broom:</span>
<span class="co"># # tidy(m)$estimate[2]^2 / (tidy(m)$estimate[2]^2 + tidy(m)$estimate[4]^2)</span>
<span class="co"># </span>
<span class="co"># # Or from sjstats:</span>
<span class="co"># # sum(get_re_var(m)) / (sum(get_re_var(m)) + get_re_var(m, &quot;sigma_2&quot;))</span>
<span class="co"># </span>
<span class="co"># save(ci_control, file = &quot;ci_control.Rdata&quot;)</span>
<span class="co"># save(ci_intervention, file = &quot;ci_intervention.Rdata&quot;)</span>
<span class="co"># save(ci_girls, file = &quot;ci_girls.Rdata&quot;)</span>
<span class="co"># save(ci_boys, file = &quot;ci_boys.Rdata&quot;)</span>

<span class="kw">load</span>(<span class="st">&quot;ci_control.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_intervention.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_girls.Rdata&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;ci_boys.Rdata&quot;</span>)</code></pre></div>
</div>
<div id="pa-determinants" class="section level1">
<h1>PA determinants</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot1 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  padaysLastweek_T1,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_diff,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_diff,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_diff,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_diff,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_diff,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_diff)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_T1 =</span> <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;0&quot;</span>,
                         <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;1-2&quot;</span>,
                                <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;3-7&quot;</span>, padaysLastweek_T1)))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">7</span><span class="op">:</span>(<span class="kw">ncol</span>(.)), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, girl),
                                    <span class="dt">point_color =</span> girl,
                                    <span class="dt">point_fill =</span> girl,
                                    <span class="dt">point_shape =</span> girl,
                                    <span class="dt">point_size =</span> girl,
                                    <span class="dt">point_alpha =</span> girl),
                                <span class="dt">scale =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="op">-</span><span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">6</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning boy&#39;</span> =<span class="st"> &quot;Boy&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning girl&#39;</span> =<span class="st"> &quot;Girl&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">24</span>, <span class="dv">25</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Self-reported MVPA days, previous week&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;padaysLastweek_T1&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot1
## Picking joint bandwidth of 0.395
## Picking joint bandwidth of 0.329
## Picking joint bandwidth of 0.301
## Warning: Removed 1731 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/bct-determinants-showdata-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
plot2 &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  padaysLastweek_T1,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_diff,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_diff,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_diff,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_diff,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_diff,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_diff
)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_T1 =</span> <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;0&quot;</span>,
                         <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;1-2&quot;</span>,
                                <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;3-7&quot;</span>, padaysLastweek_T1)))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(padaysLastweek_T1)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>tidyr<span class="op">::</span><span class="kw">gather</span>(<span class="dt">key =</span> Variable, <span class="dt">value =</span> Value, <span class="dv">7</span><span class="op">:</span>(<span class="kw">ncol</span>(.)), <span class="dt">factor_key =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Variable)) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Value,
                                    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>,
                                    <span class="dt">fill =</span> <span class="kw">paste</span>(Variable, intervention),
                                    <span class="dt">point_color =</span> intervention,
                                    <span class="dt">point_fill =</span> intervention,
                                    <span class="dt">point_shape =</span> intervention,
                                    <span class="dt">point_size =</span> intervention,
                                    <span class="dt">point_alpha =</span> intervention),
                                <span class="dt">scale =</span> .<span class="dv">9</span>, <span class="dt">alpha =</span> .<span class="dv">6</span>, <span class="dt">size =</span> <span class="fl">0.25</span>,
                                <span class="dt">from =</span> <span class="op">-</span><span class="dv">6</span>, <span class="dt">to =</span> <span class="dv">6</span>,
                                <span class="dt">position =</span> <span class="kw">position_raincloud</span>(<span class="dt">width =</span> <span class="fl">0.03</span>, <span class="dt">height =</span> <span class="fl">0.5</span>),
                                <span class="dt">jittered_points =</span> <span class="ot">TRUE</span>,
                                <span class="dt">point_size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,
       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_fill_cyclical</span>(
                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 0&#39;</span> =<span class="st"> &quot;Control&quot;</span>, <span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning 1&#39;</span> =<span class="st"> &quot;intervention&quot;</span>),
                      <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                      <span class="dt">name =</span> <span class="st">&quot;&quot;</span>, 
                      <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, 
                                                               <span class="dt">point_shape =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                                               <span class="dt">point_size =</span> <span class="dv">2</span>))) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_colour_cyclical</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>(<span class="dt">grid =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_color&quot;</span>, 
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_fill&quot;</span>,
                                  <span class="dt">values =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">4</span>, <span class="dt">end =</span> <span class="fl">0.8</span>)[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)],
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_shape&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">22</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_size&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">75</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggridges<span class="op">::</span><span class="kw">scale_discrete_manual</span>(<span class="dt">aesthetics =</span> <span class="st">&quot;point_alpha&quot;</span>, 
                                  <span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),
                                  <span class="dt">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">theme_apa</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Self-reported MVPA days, previous week&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;padaysLastweek_T1&quot;</span>)
## Warning: attributes are not identical across measure variables;
## they will be dropped

plot2
## Picking joint bandwidth of 0.413
## Picking joint bandwidth of 0.337
## Picking joint bandwidth of 0.305
## Warning: Removed 1731 rows containing non-finite values
## (stat_density_ridges).</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/bct-determinants-showdata-2.png" width="2100" /></p>
<p>Variance in changes of determinants seems different for baseline activity.</p>
<div id="variance-in-changes-by-group" class="section level2">
<h2>Variance in changes by group</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">determinants_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(id,
  intervention,
  group,
  school,
  girl,
  padaysLastweek_T1,
<span class="st">&#39;PA action and</span><span class="ch">\n</span><span class="st">coping planning&#39;</span> =<span class="st"> </span>PA_actCop_diff,
<span class="st">&#39;PA intention&#39;</span> =<span class="st"> </span>PA_intention_diff,
<span class="st">&#39;PA outcome</span><span class="ch">\n</span><span class="st">expectations&#39;</span> =<span class="st"> </span>PA_outcomeExpectations_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">behavioural control&#39;</span> =<span class="st"> </span>PA_pbc_diff,
<span class="st">&#39;PA self efficacy&#39;</span> =<span class="st"> </span>PA_selfefficacy_diff,
<span class="st">&#39;PA perceived</span><span class="ch">\n</span><span class="st">opportunities&#39;</span> =<span class="st"> </span>PA_opportunities_diff,
<span class="st">&#39;PA descriptive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_dnorm_diff,
<span class="st">&#39;PA injunctive</span><span class="ch">\n</span><span class="st">norm&#39;</span> =<span class="st"> </span>PA_inorm_diff)  <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">padaysLastweek_T1 =</span> <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;0&quot;</span>,
                         <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>padaysLastweek_T1 <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;1-2&quot;</span>,
                                <span class="kw">ifelse</span>(padaysLastweek_T1 <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>, <span class="st">&quot;3-7&quot;</span>, padaysLastweek_T1)))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA &quot;</span>)), <span class="kw">funs</span>(<span class="dt">abs_dev =</span> <span class="kw">abs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">-</span><span class="st"> </span>.)))
                

determinants_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(padaysLastweek_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">noquote</span>(<span class="kw">order</span>(<span class="kw">colnames</span>(.)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Orders columns alphabetically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA &quot;</span>)), mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["padaysLastweek_T1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["intervention"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["PA action and\ncoping planning"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PA action and\ncoping planning_abs_dev"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["PA descriptive\nnorm"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["PA descriptive\nnorm_abs_dev"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["PA injunctive\nnorm"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["PA injunctive\nnorm_abs_dev"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["PA intention"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["PA intention_abs_dev"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["PA outcome\nexpectations"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["PA outcome\nexpectations_abs_dev"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nbehavioural control"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nbehavioural control_abs_dev"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nopportunities"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nopportunities_abs_dev"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["PA self efficacy"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["PA self efficacy_abs_dev"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0.004464286","4":"0.5773603","5":"-0.214285714","6":"0.9911850","7":"-0.12727273","8":"1.461683","9":"-0.07142857","10":"1.6471404","11":"0.180221861","12":"0.5697386","13":"-0.1785714","14":"0.9507950","15":"-0.003295068","16":"0.7364479","17":"-0.03571429","18":"0.9934784"},{"1":"0","2":"1","3":"0.032986111","4":"0.6139765","5":"0.000000000","6":"1.0731374","7":"-0.26388889","8":"1.434427","9":"-0.18055556","10":"1.5599974","11":"0.058011623","12":"0.6271173","13":"-0.3888889","14":"1.0988348","15":"-0.247553816","16":"0.6620726","17":"-0.27777778","18":"1.2373592"},{"1":"1-2","2":"0","3":"0.089930556","4":"0.6176746","5":"-0.025000000","6":"0.9774277","7":"0.08333333","8":"1.290302","9":"-0.04583333","10":"1.1979963","11":"0.032321162","12":"0.6186972","13":"-0.1983471","14":"0.9150915","15":"-0.330726092","16":"0.6638734","17":"-0.02892562","18":"0.9334416"},{"1":"1-2","2":"1","3":"-0.009637188","4":"0.6176117","5":"-0.078767123","6":"1.0242339","7":"-0.28082192","8":"1.152857","9":"-0.27054795","10":"1.2427380","11":"0.277600328","12":"0.6991880","13":"-0.4149660","14":"0.9506848","15":"-0.262643678","16":"0.6380119","17":"-0.27551020","18":"0.9570245"},{"1":"3-7","2":"0","3":"-0.102011494","4":"0.5179373","5":"-0.002155172","6":"1.0457519","7":"0.01298701","8":"1.290214","9":"-0.22844828","10":"0.9876683","11":"0.020006588","12":"0.6213996","13":"-0.3773449","14":"0.9054093","15":"-0.263386470","16":"0.6617066","17":"-0.31168831","18":"1.0857647"},{"1":"3-7","2":"1","3":"-0.102144866","4":"0.5882419","5":"-0.345188285","6":"1.1951967","7":"-0.23206751","8":"1.568503","9":"-0.49789030","10":"1.0867057","11":"-0.008238636","12":"0.6343057","13":"-0.4444444","14":"0.9712659","15":"-0.332415675","16":"0.6887618","17":"-0.40871369","18":"1.2166879"},{"1":"NA","2":"0","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NaN","8":"NaN","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"},{"1":"NA","2":"1","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NaN","8":"NaN","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"},{"1":"NA","2":"NA","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NaN","8":"NaN","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">determinants_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(padaysLastweek_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">noquote</span>(<span class="kw">order</span>(<span class="kw">colnames</span>(.)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Orders columns alphabetically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">contains</span>(<span class="st">&quot;PA &quot;</span>)), sd, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["padaysLastweek_T1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["intervention"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["PA action and\ncoping planning"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PA action and\ncoping planning_abs_dev"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["PA descriptive\nnorm"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["PA descriptive\nnorm_abs_dev"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["PA injunctive\nnorm"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["PA injunctive\nnorm_abs_dev"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["PA intention"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["PA intention_abs_dev"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["PA outcome\nexpectations"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["PA outcome\nexpectations_abs_dev"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nbehavioural control"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nbehavioural control_abs_dev"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nopportunities"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["PA perceived\nopportunities_abs_dev"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["PA self efficacy"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["PA self efficacy_abs_dev"],"name":[18],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0.8040961","4":"0.5561637","5":"1.361340","6":"0.9277752","7":"2.028086","8":"1.391779","9":"2.089864","10":"1.282683","11":"0.7332124","12":"0.4681571","13":"1.327205","14":"0.9362572","15":"0.9447666","16":"0.6440294","17":"1.344542","18":"0.9273174"},{"1":"0","2":"1","3":"0.8560558","4":"0.5968120","5":"1.371234","6":"0.8536324","7":"2.041768","8":"1.449611","9":"2.171041","10":"1.501220","11":"1.0073314","12":"0.7849573","13":"1.413107","14":"0.8791949","15":"0.9483794","16":"0.6750441","17":"1.680227","18":"1.1271947"},{"1":"1-2","2":"0","3":"0.8383949","4":"0.5793126","5":"1.269967","6":"0.8122986","7":"1.858812","8":"1.349353","9":"1.604872","10":"1.085829","11":"0.8534163","12":"0.5864327","13":"1.220639","14":"0.8208173","15":"0.8594418","16":"0.5454607","17":"1.276874","18":"0.9009096"},{"1":"1-2","2":"1","3":"0.8479745","4":"0.5796788","5":"1.390470","6":"0.9377745","7":"1.591976","8":"1.104578","9":"1.731181","10":"1.200808","11":"1.0121101","12":"0.7582990","13":"1.238396","14":"0.7912668","15":"0.8694221","16":"0.5883283","17":"1.249909","18":"0.8000706"},{"1":"3-7","2":"0","3":"0.7187314","4":"0.5008286","5":"1.425265","6":"0.9739611","7":"1.945967","8":"1.460981","9":"1.478405","10":"1.098955","11":"0.8491731","12":"0.5795828","13":"1.221827","14":"0.8183358","15":"0.8639079","16":"0.5538042","17":"1.472293","18":"0.9925624"},{"1":"3-7","2":"1","3":"0.8429996","4":"0.6056767","5":"1.591432","6":"1.0705812","7":"2.176761","8":"1.509581","9":"1.557852","10":"1.137158","11":"0.9158996","12":"0.6642299","13":"1.259429","14":"0.8031970","15":"0.8995925","16":"0.5799654","17":"1.599468","18":"1.0442425"},{"1":"NA","2":"0","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NA","8":"NA","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"},{"1":"NA","2":"1","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NA","8":"NA","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"},{"1":"NA","2":"NA","3":"NaN","4":"NaN","5":"NaN","6":"NaN","7":"NA","8":"NA","9":"NaN","10":"NaN","11":"NaN","12":"NaN","13":"NaN","14":"NaN","15":"NaN","16":"NaN","17":"NaN","18":"NaN"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">determinants_df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(padaysLastweek_T1, intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="kw">noquote</span>(<span class="kw">order</span>(<span class="kw">colnames</span>(.)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># Orders columns alphabetically</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["padaysLastweek_T1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["intervention"],"name":[2],"type":["fctr"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"68"},{"1":"0","2":"1","3":"90"},{"1":"1-2","2":"0","3":"148"},{"1":"1-2","2":"1","3":"182"},{"1":"3-7","2":"0","3":"286"},{"1":"3-7","2":"1","3":"308"},{"1":"NA","2":"0","3":"1"},{"1":"NA","2":"1","3":"1"},{"1":"NA","2":"NA","3":"81"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[15],"max":[15]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="t2-networks-compared" class="section level1">
<h1>T2 networks compared</h1>
<div id="all-regulations-network" class="section level2">
<h2>All regulations network</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">18</span>
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  PA_amotivation_02_T3,
  PA_amotivation_01_T3,
  PA_amotivation_03_T3,
  PA_amotivation_04_T3,
  PA_extrinsic_01_T3,
  PA_extrinsic_02_T3,
  PA_extrinsic_03_T3,
  PA_introjected_01_T3,
  PA_introjected_02_T3,
  PA_identified_01_T3,
  PA_identified_02_T3,
  PA_identified_03_T3,
  PA_integrated_01_T3, 
  PA_integrated_02_T3,
  PA_integrated_03_T3, 
  PA_intrinsic_01_T3,
  PA_intrinsic_02_T3,
  PA_intrinsic_03_T3)

regulations.df &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(
<span class="dt">PA_amotivation_02_T3 =</span> <span class="kw">ifelse</span>(PA_amotivation_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_amotivation_01_T3 =</span> <span class="kw">ifelse</span>(PA_amotivation_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_amotivation_03_T3 =</span> <span class="kw">ifelse</span>(PA_amotivation_03_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_amotivation_04_T3 =</span> <span class="kw">ifelse</span>(PA_amotivation_04_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_extrinsic_01_T3 =</span> <span class="kw">ifelse</span>(PA_extrinsic_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_extrinsic_02_T3 =</span> <span class="kw">ifelse</span>(PA_extrinsic_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_extrinsic_03_T3 =</span> <span class="kw">ifelse</span>(PA_extrinsic_03_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_introjected_01_T3 =</span> <span class="kw">ifelse</span>(PA_introjected_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_introjected_02_T3 =</span> <span class="kw">ifelse</span>(PA_introjected_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_identified_01_T3 =</span> <span class="kw">ifelse</span>(PA_identified_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_identified_02_T3 =</span> <span class="kw">ifelse</span>(PA_identified_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_identified_03_T3 =</span> <span class="kw">ifelse</span>(PA_identified_03_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_integrated_01_T3 =</span> <span class="kw">ifelse</span>(PA_integrated_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_integrated_02_T3 =</span> <span class="kw">ifelse</span>(PA_integrated_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_integrated_03_T3 =</span> <span class="kw">ifelse</span>(PA_integrated_03_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_intrinsic_01_T3 =</span> <span class="kw">ifelse</span>(PA_intrinsic_01_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_intrinsic_02_T3 =</span> <span class="kw">ifelse</span>(PA_intrinsic_02_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),
<span class="dt">PA_intrinsic_03_T3 =</span> <span class="kw">ifelse</span>(PA_intrinsic_03_T3 <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))


### intervention AND control

S.control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) <span class="co"># %&gt;% na.omit(.) </span>
S.intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) <span class="co"># %&gt;% na.omit(.)</span>
nwcontrol &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.control, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%
nwintervention &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.intervention, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

data1 &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df))
<span class="kw">names</span>(data1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Amoti&quot;</span>, <span class="dv">4</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Extri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intro&quot;</span>, <span class="dv">2</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))
nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data1, <span class="dt">default=</span><span class="st">&quot;IsingFit&quot;</span>)
## Estimating Network. Using package::function:
##   - IsingFit::IsingFit for network computation
##     - Using glmnet::glmnet
## 
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|</span><span class="st">                                                                 </span><span class="er">|</span><span class="st">   </span><span class="dv">0</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====</span><span class="st">                                                             </span><span class="er">|</span><span class="st">   </span><span class="dv">6</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=======</span><span class="st">                                                          </span><span class="er">|</span><span class="st">  </span><span class="dv">11</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========</span><span class="st">                                                      </span><span class="er">|</span><span class="st">  </span><span class="dv">17</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==============</span><span class="st">                                                   </span><span class="er">|</span><span class="st">  </span><span class="dv">22</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==================</span><span class="st">                                               </span><span class="er">|</span><span class="st">  </span><span class="dv">28</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================</span><span class="st">                                           </span><span class="er">|</span><span class="st">  </span><span class="dv">33</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=========================</span><span class="st">                                        </span><span class="er">|</span><span class="st">  </span><span class="dv">39</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================</span><span class="st">                                    </span><span class="er">|</span><span class="st">  </span><span class="dv">44</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|================================</span><span class="st">                                 </span><span class="er">|</span><span class="st">  </span><span class="dv">50</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|====================================</span><span class="st">                             </span><span class="er">|</span><span class="st">  </span><span class="dv">56</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|========================================</span><span class="st">                         </span><span class="er">|</span><span class="st">  </span><span class="dv">61</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===========================================</span><span class="st">                      </span><span class="er">|</span><span class="st">  </span><span class="dv">67</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===============================================</span><span class="st">                  </span><span class="er">|</span><span class="st">  </span><span class="dv">72</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|===================================================</span><span class="st">              </span><span class="er">|</span><span class="st">  </span><span class="dv">78</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|======================================================</span><span class="st">           </span><span class="er">|</span><span class="st">  </span><span class="dv">83</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|==========================================================</span><span class="st">       </span><span class="er">|</span><span class="st">  </span><span class="dv">89</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=============================================================</span><span class="st">    </span><span class="er">|</span><span class="st">  </span><span class="dv">94</span>%
  <span class="op">|</span><span class="st">                                                                       </span>
<span class="st">  </span><span class="er">|=================================================================|</span><span class="st"> </span><span class="dv">100</span>%

<span class="co"># Create means for filling nodes</span>
interventionmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

controlmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

<span class="co"># Find average layout for comparability and plot graphs next to each other</span>

Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwintervention, nwcontrol)


<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))
<span class="kw">plot</span>(nwintervention, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;intervention&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">pie =</span> interventionmeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwcontrol, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;control&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">pie =</span> controlmeans, 
     <span class="dt">color =</span> <span class="st">&quot;skyblue&quot;</span>,
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-allregulations-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
itemNames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;I can</span><span class="ch">\&#39;</span><span class="st">t see why I should bother exercising&#39;</span>,
  <span class="st">&#39;I do not see why I should have to exercise&#39;</span>,
  <span class="st">&#39; I do not see the point in exercising&#39;</span>,
  <span class="st">&#39; I think exercising is a waste of time&#39;</span>,
  <span class="st">&#39; I exercise because other people say I should&#39;</span>,
  <span class="st">&#39; I exercise because others will not be pleased with me if I do not&#39;</span>,
  <span class="st">&#39; I feel under pressure from my friends/family to exercise&#39;</span>,
  <span class="st">&#39; I feel guilty when I do not exercise&#39;</span>,
  <span class="st">&#39; I feel like a failure when I have not exercised in a while&#39;</span>,
  <span class="st">&#39; I think it is important to make the effort to exercise regularly&#39;</span>,
  <span class="st">&#39; I value the benefits of exercise&#39;</span>,
  <span class="st">&#39; it is important to me to exercise regularly&#39;</span>,
  <span class="st">&#39; I exercise because it is consistent with my life goals.&#39;</span>,
  <span class="st">&#39; I consider exercise consistent with my values.&#39;</span>,
  <span class="st">&#39; I consider exercise a fundamental part of who I am.&#39;</span>,
  <span class="st">&#39; I get pleasure and satisfaction from participating in exercise&#39;</span>,
  <span class="st">&#39; I exercise because it is fun&#39;</span>,
  <span class="st">&#39; I enjoy my exercise sessions&#39;</span>)

itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Amotivation&quot;</span>, <span class="dv">4</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Extrinsic&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Introjected&quot;</span>, <span class="dv">2</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Identified&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Integrated&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Intrinsic&quot;</span>, <span class="dv">3</span>))


<span class="kw">plot</span>(nwAll, <span class="dt">groups =</span> itemGroups, <span class="dt">nodeNames =</span> itemNames, <span class="dt">legend.cex =</span> <span class="fl">0.25</span>)</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-allregulations-2.png" width="2100" /></p>
</div>
</div>
<div id="autonomous-motivation-network" class="section level1">
<h1>Autonomous motivation network</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">9</span>
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  <span class="co"># PA_amotivation_02_T3,</span>
  <span class="co"># PA_amotivation_01_T3,</span>
  <span class="co"># PA_amotivation_03_T3,</span>
  <span class="co"># PA_amotivation_04_T3,</span>
  <span class="co"># PA_extrinsic_01_T3,</span>
  <span class="co"># PA_extrinsic_02_T3,</span>
  <span class="co"># PA_extrinsic_03_T3,</span>
  <span class="co"># PA_introjected_01_T3,</span>
  <span class="co"># PA_introjected_02_T3,</span>
  PA_identified_01_T3,
  PA_identified_02_T3,
  PA_identified_03_T3,
  PA_integrated_01_T3, 
  PA_integrated_02_T3,
  PA_integrated_03_T3, 
  PA_intrinsic_01_T3,
  PA_intrinsic_02_T3,
  PA_intrinsic_03_T3)

<span class="co"># regulations.df &lt;- regulations.df %&gt;% mutate(</span>
<span class="co"># PA_amotivation_02_T3 = ifelse(PA_amotivation_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_01_T3 = ifelse(PA_amotivation_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_03_T3 = ifelse(PA_amotivation_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_04_T3 = ifelse(PA_amotivation_04_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_01_T3 = ifelse(PA_extrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_02_T3 = ifelse(PA_extrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_03_T3 = ifelse(PA_extrinsic_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_01_T3 = ifelse(PA_introjected_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_02_T3 = ifelse(PA_introjected_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_01_T3 = ifelse(PA_identified_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_02_T3 = ifelse(PA_identified_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_03_T3 = ifelse(PA_identified_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_01_T3 = ifelse(PA_integrated_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_02_T3 = ifelse(PA_integrated_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_03_T3 = ifelse(PA_integrated_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_01_T3 = ifelse(PA_intrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_02_T3 = ifelse(PA_intrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_03_T3 = ifelse(PA_intrinsic_03_T3 == 1, 0, 1))</span>
<span class="co"># </span>

### intervention and control

S.control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.control) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))

S.intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))

nwcontrol &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.control, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.
nwintervention &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.intervention, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

data1 &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df))
<span class="kw">names</span>(data1) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))
nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data1, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal =
## penalize.diagonal, : Network with lowest lambda selected as best network.
## Try setting &#39;lambda.min.ratio&#39; lower.

## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

<span class="co"># Create means for filling nodes</span>
interventionmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

controlmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

<span class="co"># Find average layout for comparability and plot graphs next to each other</span>

Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwintervention, nwcontrol)

itemNames &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="co"># &#39;I can\&#39;t see why I should bother exercising&#39;,</span>
  <span class="co"># &#39;I do not see why I should have to exercise&#39;,</span>
  <span class="co"># &#39; I do not see the point in exercising&#39;,</span>
  <span class="co"># &#39; I think exercising is a waste of time&#39;,</span>
  <span class="co"># &#39; I exercise because other people say I should&#39;,</span>
  <span class="co"># &#39; I exercise because others will not be pleased with me if I do not&#39;,</span>
  <span class="co"># &#39; I feel under pressure from my friends/family to exercise&#39;,</span>
  <span class="co"># &#39; I feel guilty when I do not exercise&#39;,</span>
  <span class="co"># &#39; I feel like a failure when I have not exercised in a while&#39;,</span>
  <span class="st">&#39; I think it is important to make the</span><span class="ch">\n</span><span class="st">effort to exercise regularly&#39;</span>,
  <span class="st">&#39; I value the benefits of exercise&#39;</span>,
  <span class="st">&#39; it is important to me to exercise</span><span class="ch">\n</span><span class="st">regularly&#39;</span>,
  <span class="st">&#39; I exercise because it is consistent</span><span class="ch">\n</span><span class="st">with my life goals.&#39;</span>,
  <span class="st">&#39; I consider exercise consistent with</span><span class="ch">\n</span><span class="st">my values.&#39;</span>,
  <span class="st">&#39; I consider exercise a fundamental</span><span class="ch">\n</span><span class="st">part of who I am.&#39;</span>,
  <span class="st">&#39; I get pleasure and satisfaction from</span><span class="ch">\n</span><span class="st">participating in exercise&#39;</span>,
  <span class="st">&#39; I exercise because it is fun&#39;</span>,
  <span class="st">&#39; I enjoy my exercise sessions&#39;</span>)

itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># rep(&quot;Amotivation&quot;, 4),</span>
                <span class="co"># rep(&quot;Extrinsic&quot;, 3),</span>
                <span class="co"># rep(&quot;Introjected&quot;, 2),</span>
                <span class="kw">rep</span>(<span class="st">&quot;Identified&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Integrated&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Intrinsic&quot;</span>, <span class="dv">3</span>))

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))
<span class="kw">plot</span>(nwintervention, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;intervention&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> interventionmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwcontrol, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;control&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> controlmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">layout</span>(<span class="dv">1</span>)
<span class="kw">plot</span>(nwAll, <span class="dt">groups =</span> itemGroups, <span class="dt">nodeNames =</span> itemNames, <span class="dt">legend.cex =</span> <span class="fl">0.4</span>,
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">3</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">layoutOffset =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.75</span>, <span class="dv">0</span>))</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-2.png" width="2100" /></p>
<div id="autonomous-motivation-ind.-items-network-with-pa-1" class="section level2">
<h2>Autonomous motivation (ind. items) network with PA 1</h2>
<p>Both accelerometer-measured MVPA (one week after filling out the survey) and self-reported PA (referring to the week prior to survey).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  <span class="co"># PA_amotivation_02_T3,</span>
  <span class="co"># PA_amotivation_01_T3,</span>
  <span class="co"># PA_amotivation_03_T3,</span>
  <span class="co"># PA_amotivation_04_T3,</span>
  <span class="co"># PA_extrinsic_01_T3,</span>
  <span class="co"># PA_extrinsic_02_T3,</span>
  <span class="co"># PA_extrinsic_03_T3,</span>
  <span class="co"># PA_introjected_01_T3,</span>
  <span class="co"># PA_introjected_02_T3,</span>
  PA_identified_01_T3,
  PA_identified_02_T3,
  PA_identified_03_T3,
  PA_integrated_01_T3, 
  PA_integrated_02_T3,
  PA_integrated_03_T3, 
  PA_intrinsic_01_T3,
  PA_intrinsic_02_T3,
  PA_intrinsic_03_T3,
  padaysLastweek_T3,
  paAccelerometer_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)), <span class="kw">funs</span>(as.numeric))

nItems &lt;-<span class="st"> </span><span class="dv">9</span>

<span class="co"># regulations.df &lt;- regulations.df %&gt;% mutate(</span>
<span class="co"># PA_amotivation_02_T3 = ifelse(PA_amotivation_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_01_T3 = ifelse(PA_amotivation_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_03_T3 = ifelse(PA_amotivation_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_04_T3 = ifelse(PA_amotivation_04_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_01_T3 = ifelse(PA_extrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_02_T3 = ifelse(PA_extrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_03_T3 = ifelse(PA_extrinsic_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_01_T3 = ifelse(PA_introjected_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_02_T3 = ifelse(PA_introjected_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_01_T3 = ifelse(PA_identified_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_02_T3 = ifelse(PA_identified_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_03_T3 = ifelse(PA_identified_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_01_T3 = ifelse(PA_integrated_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_02_T3 = ifelse(PA_integrated_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_03_T3 = ifelse(PA_integrated_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_01_T3 = ifelse(PA_intrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_02_T3 = ifelse(PA_intrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_03_T3 = ifelse(PA_intrinsic_03_T3 == 1, 0, 1))</span>
<span class="co"># </span>

### intervention and control

S.control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.control) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-Rep.&quot;</span>)

S.intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-Rep.&quot;</span>)

nwcontrol &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.control, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.
nwintervention &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.intervention, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

data1 &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df))
<span class="kw">names</span>(data1) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 3), 1:3),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">3</span>), <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-rep.&quot;</span>)

nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data1, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Variables detected as ordinal: Ident1; Ident2; Ident3; Integ1; Integ2; Integ3; Intri1; Intri2; Intri3
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

<span class="co"># Create means for filling nodes</span>
interventionmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>paAccelerometer_T3, <span class="op">-</span>padaysLastweek_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

regulations.df_intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
interventionmeans<span class="op">$</span>Accelerometer &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_intervention<span class="op">$</span>paAccelerometer_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>)
interventionmeans<span class="op">$</span><span class="st">`</span><span class="dt">Self-report</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_intervention<span class="op">$</span>padaysLastweek_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span>

controlmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>paAccelerometer_T3, <span class="op">-</span>padaysLastweek_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

regulations.df_control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
controlmeans<span class="op">$</span>Accelerometer &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_control<span class="op">$</span>paAccelerometer_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>)
controlmeans<span class="op">$</span><span class="st">`</span><span class="dt">Self-report</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_control<span class="op">$</span>padaysLastweek_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span>

<span class="co"># Find average layout for comparability and plot graphs next to each other</span>

Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwintervention, nwcontrol)

itemNames &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="co"># &#39;I can\&#39;t see why I should bother exercising&#39;,</span>
  <span class="co"># &#39;I do not see why I should have to exercise&#39;,</span>
  <span class="co"># &#39; I do not see the point in exercising&#39;,</span>
  <span class="co"># &#39; I think exercising is a waste of time&#39;,</span>
  <span class="co"># &#39; I exercise because other people say I should&#39;,</span>
  <span class="co"># &#39; I exercise because others will not be pleased with me if I do not&#39;,</span>
  <span class="co"># &#39; I feel under pressure from my friends/family to exercise&#39;,</span>
  <span class="co"># &#39; I feel guilty when I do not exercise&#39;,</span>
  <span class="co"># &#39; I feel like a failure when I have not exercised in a while&#39;,</span>
  <span class="st">&#39; I think it is important to make the</span><span class="ch">\n</span><span class="st">effort to exercise regularly&#39;</span>,
  <span class="st">&#39; I value the benefits of exercise&#39;</span>,
  <span class="st">&#39; it is important to me to exercise</span><span class="ch">\n</span><span class="st">regularly&#39;</span>,
  <span class="st">&#39; I exercise because it is consistent</span><span class="ch">\n</span><span class="st">with my life goals.&#39;</span>,
  <span class="st">&#39; I consider exercise consistent with</span><span class="ch">\n</span><span class="st">my values.&#39;</span>,
  <span class="st">&#39; I consider exercise a fundamental</span><span class="ch">\n</span><span class="st">part of who I am.&#39;</span>,
  <span class="st">&#39; I get pleasure and satisfaction from</span><span class="ch">\n</span><span class="st">participating in exercise&#39;</span>,
  <span class="st">&#39; I exercise because it is fun&#39;</span>,
  <span class="st">&#39; I enjoy my exercise sessions&#39;</span>)

itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># rep(&quot;Amotivation&quot;, 4),</span>
                <span class="co"># rep(&quot;Extrinsic&quot;, 3),</span>
                <span class="co"># rep(&quot;Introjected&quot;, 2),</span>
                <span class="kw">rep</span>(<span class="st">&quot;Identified&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Integrated&quot;</span>, <span class="dv">3</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Intrinsic&quot;</span>, <span class="dv">3</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-rep.&quot;</span>)

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))
<span class="kw">plot</span>(nwintervention, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;intervention&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> interventionmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwcontrol, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;control&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> controlmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-PA-indItems-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">layout</span>(<span class="dv">1</span>)
<span class="kw">plot</span>(nwAll, <span class="dt">groups =</span> itemGroups, <span class="dt">nodeNames =</span> itemNames, <span class="dt">legend.cex =</span> <span class="fl">0.4</span>,
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">layoutOffset =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.75</span>, <span class="dv">0</span>))</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-PA-indItems-2.png" width="2100" /></p>
<div id="network-comparison-test" class="section level3">
<h3>Network comparison test</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># nct_results_interventionAllocation &lt;- NetworkComparisonTest::NCT(S.control, S.intervention, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span>
<span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span>
<span class="co"># </span>
<span class="co"># save(nct_results_interventionAllocation, file=&quot;nct_results_interventionAllocation.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;nct_results_interventionAllocation.Rdata&quot;</span>)</code></pre></div>
<p>Print results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)</code></pre></div>
<p>[1] “Similarity”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Correlation between intervention and control edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(nwintervention)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(nwcontrol)<span class="op">$</span>InDegree))</code></pre></div>
<p>Correlation between intervention and control edge strengths: 0.9233915</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Correlation between intervention and control networks:&quot;</span>, <span class="kw">cor</span>(nwintervention<span class="op">$</span>graph[<span class="kw">lower.tri</span>(nwintervention<span class="op">$</span>graph)], nwcontrol<span class="op">$</span>graph[<span class="kw">lower.tri</span>(nwintervention<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))</code></pre></div>
<p>Correlation between intervention and control networks: 0.6662521</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)</code></pre></div>
<p>[1] “Difference”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results_interventionAllocation<span class="op">$</span>nwinv.pval)</code></pre></div>
<p>P-value for the test of identical network structure: 0.156</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results_interventionAllocation<span class="op">$</span>glstrinv.pval)</code></pre></div>
<p>P-value for the test of identical connectivity in networks: 0.817</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nct_results_interventionAllocation<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between intervention and control group networks&quot;</span>)</code></pre></div>
<caption>
(#tab:nct-results-individual-autonomous-items)
</caption>
<caption>
<em>p-values on difference test in edges between intervention and control group networks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>12</td>
<td align="left">Ident1</td>
<td align="left">Ident2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>23</td>
<td align="left">Ident1</td>
<td align="left">Ident3</td>
<td align="left">0.16</td>
</tr>
<tr class="odd">
<td>24</td>
<td align="left">Ident2</td>
<td align="left">Ident3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>34</td>
<td align="left">Ident1</td>
<td align="left">Integ1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>35</td>
<td align="left">Ident2</td>
<td align="left">Integ1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>36</td>
<td align="left">Ident3</td>
<td align="left">Integ1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>45</td>
<td align="left">Ident1</td>
<td align="left">Integ2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>46</td>
<td align="left">Ident2</td>
<td align="left">Integ2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>47</td>
<td align="left">Ident3</td>
<td align="left">Integ2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>48</td>
<td align="left">Integ1</td>
<td align="left">Integ2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>56</td>
<td align="left">Ident1</td>
<td align="left">Integ3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>57</td>
<td align="left">Ident2</td>
<td align="left">Integ3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>58</td>
<td align="left">Ident3</td>
<td align="left">Integ3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>59</td>
<td align="left">Integ1</td>
<td align="left">Integ3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>60</td>
<td align="left">Integ2</td>
<td align="left">Integ3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>67</td>
<td align="left">Ident1</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>68</td>
<td align="left">Ident2</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>69</td>
<td align="left">Ident3</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>70</td>
<td align="left">Integ1</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>71</td>
<td align="left">Integ2</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>72</td>
<td align="left">Integ3</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>78</td>
<td align="left">Ident1</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>79</td>
<td align="left">Ident2</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>80</td>
<td align="left">Ident3</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>81</td>
<td align="left">Integ1</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>82</td>
<td align="left">Integ2</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>83</td>
<td align="left">Integ3</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>84</td>
<td align="left">Intri1</td>
<td align="left">Intri2</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>89</td>
<td align="left">Ident1</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>90</td>
<td align="left">Ident2</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>91</td>
<td align="left">Ident3</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>92</td>
<td align="left">Integ1</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>93</td>
<td align="left">Integ2</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>94</td>
<td align="left">Integ3</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>95</td>
<td align="left">Intri1</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>96</td>
<td align="left">Intri2</td>
<td align="left">Intri3</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>100</td>
<td align="left">Ident1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>101</td>
<td align="left">Ident2</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>102</td>
<td align="left">Ident3</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>103</td>
<td align="left">Integ1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>104</td>
<td align="left">Integ2</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>105</td>
<td align="left">Integ3</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>106</td>
<td align="left">Intri1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>107</td>
<td align="left">Intri2</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>108</td>
<td align="left">Intri3</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>111</td>
<td align="left">Ident1</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>112</td>
<td align="left">Ident2</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>113</td>
<td align="left">Ident3</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>114</td>
<td align="left">Integ1</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>115</td>
<td align="left">Integ2</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>116</td>
<td align="left">Integ3</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>117</td>
<td align="left">Intri1</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>118</td>
<td align="left">Intri2</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>119</td>
<td align="left">Intri3</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>120</td>
<td align="left">Accelerom.</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results_interventionAllocation<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))</code></pre></div>
<p>Number of edges, which appear different (p&lt;0.05): 0</p>
</div>
</div>
<div id="autonomous-motivation-sumscores-network-with-pa-1" class="section level2">
<h2>Autonomous motivation (sumscores) network with PA 1</h2>
<p>Both accelerometer-measured MVPA (one week after filling out the survey) and self-reported PA (referring to the week prior to survey).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nItems &lt;-<span class="st"> </span><span class="dv">3</span>
regulations.df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(
  id,
  intervention,
  group,
  school,
  girl,
  <span class="co"># PA_amotivation_02_T3,</span>
  <span class="co"># PA_amotivation_01_T3,</span>
  <span class="co"># PA_amotivation_03_T3,</span>
  <span class="co"># PA_amotivation_04_T3,</span>
  <span class="co"># PA_extrinsic_01_T3,</span>
  <span class="co"># PA_extrinsic_02_T3,</span>
  <span class="co"># PA_extrinsic_03_T3,</span>
  <span class="co"># PA_introjected_01_T3,</span>
  <span class="co"># PA_introjected_02_T3,</span>
  PA_identified_T3,
  PA_integrated_T3, 
  PA_intrinsic_T3,
  padaysLastweek_T3,
  paAccelerometer_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(<span class="op">-</span>(id<span class="op">:</span>girl)), <span class="kw">funs</span>(as.numeric))

<span class="co"># regulations.df &lt;- regulations.df %&gt;% mutate(</span>
<span class="co"># PA_amotivation_02_T3 = ifelse(PA_amotivation_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_01_T3 = ifelse(PA_amotivation_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_03_T3 = ifelse(PA_amotivation_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_amotivation_04_T3 = ifelse(PA_amotivation_04_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_01_T3 = ifelse(PA_extrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_02_T3 = ifelse(PA_extrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_extrinsic_03_T3 = ifelse(PA_extrinsic_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_01_T3 = ifelse(PA_introjected_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_introjected_02_T3 = ifelse(PA_introjected_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_01_T3 = ifelse(PA_identified_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_02_T3 = ifelse(PA_identified_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_identified_03_T3 = ifelse(PA_identified_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_01_T3 = ifelse(PA_integrated_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_02_T3 = ifelse(PA_integrated_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_integrated_03_T3 = ifelse(PA_integrated_03_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_01_T3 = ifelse(PA_intrinsic_01_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_02_T3 = ifelse(PA_intrinsic_02_T3 == 1, 0, 1),</span>
<span class="co"># PA_intrinsic_03_T3 = ifelse(PA_intrinsic_03_T3 == 1, 0, 1))</span>
<span class="co"># </span>

### intervention and control

S.control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.control) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 1), 1),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-Rep.&quot;</span>)

S.intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df)) 

<span class="kw">names</span>(S.intervention) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 1), 1),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-Rep.&quot;</span>)

nwcontrol &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.control, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.
nwintervention &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(S.intervention, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal =
## penalize.diagonal, : Network with lowest lambda selected as best network.
## Try setting &#39;lambda.min.ratio&#39; lower.

## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

data1 &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dv">6</span><span class="op">:</span><span class="kw">ncol</span>(regulations.df))
<span class="kw">names</span>(data1) &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># paste0(rep(&quot;Amoti&quot;, 4), 1:4),</span>
                <span class="co"># paste0(rep(&quot;Extri&quot;, 1), 1),</span>
                <span class="co"># paste0(rep(&quot;Intro&quot;, 2), 1:2),</span>
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Ident&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Integ&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="kw">paste0</span>(<span class="kw">rep</span>(<span class="st">&quot;Intri&quot;</span>, <span class="dv">1</span>), <span class="dv">1</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-rep.&quot;</span>)

nwAll &lt;-<span class="st"> </span>bootnet<span class="op">::</span><span class="kw">estimateNetwork</span>(data1, <span class="dt">default=</span><span class="st">&quot;EBICglasso&quot;</span>)
## Estimating Network. Using package::function:
##   - qgraph::EBICglasso for EBIC model selection
##     - using glasso::glasso
##   - qgraph::cor_auto for correlation computation
##     - using lavaan::lavCor
## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal =
## penalize.diagonal, : Network with lowest lambda selected as best network.
## Try setting &#39;lambda.min.ratio&#39; lower.

## Warning in EBICglassoCore(S = S, n = n, gamma = gamma, penalize.diagonal
## = penalize.diagonal, : A dense regularized network was selected (lambda &lt;
## 0.1 * lambda.max). Recent work indicates a possible drop in specificity.
## Interpret the presence of the smallest edges with care. Setting threshold =
## TRUE will enforce high specificity, at the cost of sensitivity.

<span class="co"># Create means for filling nodes</span>
interventionmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>paAccelerometer_T3, <span class="op">-</span>padaysLastweek_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

regulations.df_intervention &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
interventionmeans<span class="op">$</span>Accelerometer &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_intervention<span class="op">$</span>paAccelerometer_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>)
interventionmeans<span class="op">$</span><span class="st">`</span><span class="dt">Self-report</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_intervention<span class="op">$</span>padaysLastweek_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span>

controlmeans &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(intervention) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>paAccelerometer_T3, <span class="op">-</span>padaysLastweek_T3) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="dv">5</span><span class="op">:</span>(<span class="dv">5</span><span class="op">+</span>nItems<span class="op">-</span><span class="dv">1</span>)),
  <span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> &quot;0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span><span class="dv">1</span>)

regulations.df_control &lt;-<span class="st"> </span>regulations.df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(intervention <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)
controlmeans<span class="op">$</span>Accelerometer &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_control<span class="op">$</span>paAccelerometer_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">60</span><span class="op">*</span><span class="dv">24</span>)
controlmeans<span class="op">$</span><span class="st">`</span><span class="dt">Self-report</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(regulations.df_control<span class="op">$</span>padaysLastweek_T3, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">/</span><span class="st"> </span><span class="dv">7</span>

<span class="co"># Find average layout for comparability and plot graphs next to each other</span>

Layout &lt;-<span class="st"> </span>qgraph<span class="op">::</span><span class="kw">averageLayout</span>(nwintervention, nwcontrol)

itemNames &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="co"># &#39;I can\&#39;t see why I should bother exercising&#39;,</span>
  <span class="co"># &#39;I do not see why I should have to exercise&#39;,</span>
  <span class="co"># &#39; I do not see the point in exercising&#39;,</span>
  <span class="co"># &#39; I think exercising is a waste of time&#39;,</span>
  <span class="co"># &#39; I exercise because other people say I should&#39;,</span>
  <span class="co"># &#39; I exercise because others will not be pleased with me if I do not&#39;,</span>
  <span class="co"># &#39; I feel under pressure from my friends/family to exercise&#39;,</span>
  <span class="co"># &#39; I feel guilty when I do not exercise&#39;,</span>
  <span class="co"># &#39; I feel like a failure when I have not exercised in a while&#39;,</span>
  <span class="st">&#39; I think it is important to make the</span><span class="ch">\n</span><span class="st">effort to exercise regularly&#39;</span>,
  <span class="st">&#39; I value the benefits of exercise&#39;</span>,
  <span class="st">&#39; it is important to me to exercise</span><span class="ch">\n</span><span class="st">regularly&#39;</span>,
  <span class="st">&#39; I exercise because it is consistent</span><span class="ch">\n</span><span class="st">with my life goals.&#39;</span>,
  <span class="st">&#39; I consider exercise consistent with</span><span class="ch">\n</span><span class="st">my values.&#39;</span>,
  <span class="st">&#39; I consider exercise a fundamental</span><span class="ch">\n</span><span class="st">part of who I am.&#39;</span>,
  <span class="st">&#39; I get pleasure and satisfaction from</span><span class="ch">\n</span><span class="st">participating in exercise&#39;</span>,
  <span class="st">&#39; I exercise because it is fun&#39;</span>,
  <span class="st">&#39; I enjoy my exercise sessions&#39;</span>)

itemGroups &lt;-<span class="st"> </span><span class="kw">c</span>(
                <span class="co"># rep(&quot;Amotivation&quot;, 4),</span>
                <span class="co"># rep(&quot;Extrinsic&quot;, 3),</span>
                <span class="co"># rep(&quot;Introjected&quot;, 2),</span>
                <span class="kw">rep</span>(<span class="st">&quot;Identified&quot;</span>, <span class="dv">1</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Integrated&quot;</span>, <span class="dv">1</span>),
                <span class="kw">rep</span>(<span class="st">&quot;Intrinsic&quot;</span>, <span class="dv">1</span>),
                <span class="st">&quot;Accelerom.&quot;</span>,
                <span class="st">&quot;Self-rep.&quot;</span>)

<span class="kw">layout</span>(<span class="kw">t</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))
<span class="kw">plot</span>(nwintervention, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;intervention&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>,
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> interventionmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)

<span class="kw">plot</span>(nwcontrol, <span class="dt">layout =</span> Layout, <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">&quot;control&quot;</span>, <span class="dt">label.cex =</span> <span class="fl">0.75</span>, 
     <span class="dt">groups =</span> itemGroups,
     <span class="dt">pie =</span> controlmeans, 
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">pieBorder =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-PA-1.png" width="2100" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">layout</span>(<span class="dv">1</span>)
<span class="kw">plot</span>(nwAll, <span class="dt">groups =</span> itemGroups, <span class="dt">nodeNames =</span> itemNames, <span class="dt">legend.cex =</span> <span class="fl">0.4</span>,
     <span class="dt">color =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">5</span>, <span class="dt">begin =</span> <span class="fl">0.5</span>, <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>),
     <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">layoutOffset =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.75</span>, <span class="dv">0</span>))</code></pre></div>
<p><img src="mechanisms-supplement_files/figure-html/network-autonomous-PA-2.png" width="2100" /></p>
<div id="network-comparison-test-1" class="section level3">
<h3>Network comparison test</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># nct_results_interventionAllocation_combined_items &lt;- NetworkComparisonTest::NCT(S.control, S.intervention, it=1000, binary.data=FALSE, paired=FALSE, test.edges=TRUE,</span>
<span class="co"># edges=&#39;all&#39;, progressbar=TRUE)</span>
<span class="co"># </span>
<span class="co"># save(nct_results_interventionAllocation_combined_items, file=&quot;nct_results_interventionAllocation_combined_items.Rdata&quot;)</span>
<span class="kw">load</span>(<span class="st">&quot;nct_results_interventionAllocation_combined_items.Rdata&quot;</span>)</code></pre></div>
<p>Print results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Similarity&quot;</span>)</code></pre></div>
<p>[1] “Similarity”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;Correlation between intervention and control edge strengths:&quot;</span>, <span class="kw">cor</span>(qgraph<span class="op">::</span><span class="kw">centrality</span>(nwintervention)<span class="op">$</span>InDegree, qgraph<span class="op">::</span><span class="kw">centrality</span>(nwcontrol)<span class="op">$</span>InDegree))</code></pre></div>
<p>Correlation between intervention and control edge strengths: 0.963327</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Correlation between intervention and control networks:&quot;</span>, <span class="kw">cor</span>(nwintervention<span class="op">$</span>graph[<span class="kw">lower.tri</span>(nwintervention<span class="op">$</span>graph)], nwcontrol<span class="op">$</span>graph[<span class="kw">lower.tri</span>(nwintervention<span class="op">$</span>graph)], <span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>))</code></pre></div>
<p>Correlation between intervention and control networks: 0.6121212</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">print</span>(<span class="st">&quot;Difference&quot;</span>)</code></pre></div>
<p>[1] “Difference”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical network structure:&quot;</span>, nct_results_interventionAllocation_combined_items<span class="op">$</span>nwinv.pval)</code></pre></div>
<p>P-value for the test of identical network structure: 0.131</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(<span class="st">&quot;P-value for the test of identical connectivity in networks:&quot;</span>, nct_results_interventionAllocation_combined_items<span class="op">$</span>glstrinv.pval)</code></pre></div>
<p>P-value for the test of identical connectivity in networks: 0.966</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nct_results_interventionAllocation_combined_items<span class="op">$</span>einv.pvals <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>papaja<span class="op">::</span><span class="kw">apa_table</span>(<span class="dt">caption =</span> <span class="st">&quot;p-values on difference test in edges between intervention and control group networks&quot;</span>)</code></pre></div>
<caption>
(#tab:nct-results-combined-autonomous-items)
</caption>
<caption>
<em>p-values on difference test in edges between intervention and control group networks</em>
</caption>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">Var1</th>
<th align="left">Var2</th>
<th align="left">p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td align="left">Ident1</td>
<td align="left">Integ1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>11</td>
<td align="left">Ident1</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>12</td>
<td align="left">Integ1</td>
<td align="left">Intri1</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>16</td>
<td align="left">Ident1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>17</td>
<td align="left">Integ1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>18</td>
<td align="left">Intri1</td>
<td align="left">Accelerom.</td>
<td align="left">1.00</td>
</tr>
<tr class="odd">
<td>21</td>
<td align="left">Ident1</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>22</td>
<td align="left">Integ1</td>
<td align="left">Self-Rep.</td>
<td align="left">0.10</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="left">Intri1</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
<tr class="even">
<td>24</td>
<td align="left">Accelerom.</td>
<td align="left">Self-Rep.</td>
<td align="left">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">cat</span>(<span class="st">&quot;Number of edges, which appear different (p&lt;0.05):&quot;</span>, <span class="kw">sum</span>(nct_results_interventionAllocation_combined_items<span class="op">$</span>einv.pvals<span class="op">$</span><span class="st">&quot;p-value&quot;</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>))</code></pre></div>
<p>Number of edges, which appear different (p&lt;0.05): 0</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
